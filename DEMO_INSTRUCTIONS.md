# ğŸ¯ Demo Instructions - System Owner Tenant Creation

## âœ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø´ØºØ§Ù„ Ø§Ù„Ø¢Ù†!

### ğŸŒ URLs
- **Backend API**: http://localhost:5243
- **Frontend**: http://localhost:3000

---

## ğŸ” Test Credentials

### SystemOwner (Ù„Ø¥Ù†Ø´Ø§Ø¡ Tenants Ø¬Ø¯ÙŠØ¯Ø©)
```
Email: owner@kasserpro.com
Password: Owner@123
```

### Admin (Ù„Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ø§Ø¯ÙŠØ©)
```
Email: admin@kasserpro.com
Password: Admin@123
```

### Cashier (Ù„Ù„ÙƒØ§Ø´ÙŠØ±)
```
Email: ahmed@kasserpro.com
Password: 123456
```

---

## ğŸ“‹ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ¬Ø±Ø¨Ø©

### 1ï¸âƒ£ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙƒÙ€ SystemOwner

1. Ø§ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­ Ø¹Ù„Ù‰: http://localhost:3000
2. Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ù€:
   - Email: `owner@kasserpro.com`
   - Password: `Owner@123`

### 2ï¸âƒ£ Ø§Ù„ÙˆØµÙˆÙ„ Ù„ØµÙØ­Ø© Ø¥Ù†Ø´Ø§Ø¡ Tenant

Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ Ø§Ø°Ù‡Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¥Ù„Ù‰:
```
http://localhost:3000/owner/tenants
```

Ø£Ùˆ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· ÙÙŠ Ø§Ù„Ù€ navigation menu Ù„Ø§Ø­Ù‚Ø§Ù‹.

### 3ï¸âƒ£ Ø¥Ù†Ø´Ø§Ø¡ Tenant Ø¬Ø¯ÙŠØ¯

Ø§Ù…Ù„Ø£ Ø§Ù„ÙÙˆØ±Ù…:
- **Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©**: Ù…Ø«Ø§Ù„: "Ù…Ø·Ø¹Ù… Ø§Ù„Ø£Ù…Ù„"
- **Ø§Ø³Ù… Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ**: Ù…Ø«Ø§Ù„: "Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"
- **Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù„Ù„Ù…Ø¯ÙŠØ±**: Ù…Ø«Ø§Ù„: "admin@amal.com"
- **ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±**: Ù…Ø«Ø§Ù„: "SecurePass123"

Ø§Ø¶ØºØ· "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø±ÙƒØ©"

### 4ï¸âƒ£ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ø¬Ø§Ø­

âœ… Ø³ØªØ¸Ù‡Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­: "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­"

âœ… Ø§Ù„ÙÙˆØ±Ù… Ø³ÙŠØªÙ… Ù…Ø³Ø­Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹

âœ… ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ù†Ø´Ø§Ø¡ tenant Ø¢Ø®Ø±

### 5ï¸âƒ£ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ù€ Tenant Ø§Ù„Ø¬Ø¯ÙŠØ¯

1. Ø§Ø¶ØºØ· Logout
2. Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:
   - Email: `admin@amal.com`
   - Password: `SecurePass123`
3. Ø³ØªØ¬Ø¯ Ù†ÙØ³Ùƒ ÙÙŠ tenant Ù…Ù†ÙØµÙ„ ØªÙ…Ø§Ù…Ø§Ù‹!

---

## ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù€ API Ù…Ø¨Ø§Ø´Ø±Ø© (Postman/curl)

### Get JWT Token (Login as SystemOwner)

```bash
POST http://localhost:5243/api/auth/login
Content-Type: application/json

{
  "email": "owner@kasserpro.com",
  "password": "Owner@123"
}
```

**Response:**
```json
{
  "success": true,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 5,
      "name": "System Owner",
      "email": "owner@kasserpro.com",
      "role": "SystemOwner"
    }
  }
}
```

### Create New Tenant

```bash
POST http://localhost:5243/api/system/tenants
Authorization: Bearer <your_token_here>
Content-Type: application/json

{
  "tenantName": "Ù…Ø·Ø¹Ù… Ø§Ù„Ø£Ù…Ù„",
  "adminEmail": "admin@amal.com",
  "adminPassword": "SecurePass123",
  "branchName": "Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ"
}
```

**Expected Response (200 OK):**
```json
{
  "success": true,
  "data": {
    "tenantId": 2,
    "tenantName": "Ù…Ø·Ø¹Ù… Ø§Ù„Ø£Ù…Ù„",
    "tenantSlug": "Ù…Ø·Ø¹Ù…-Ø§Ù„Ø£Ù…Ù„",
    "branchId": 3,
    "branchName": "Ø§Ù„ÙØ±Ø¹ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ",
    "adminUserId": 6,
    "adminEmail": "admin@amal.com"
  },
  "message": "ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø±ÙƒØ© Ø¨Ù†Ø¬Ø§Ø­"
}
```

---

## ğŸ”’ Security Features Demonstrated

### âœ… Role-Based Authorization
- Ø¬Ø±Ø¨ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù„Ù‰ `/owner/tenants` Ø¨Ù€ Admin Ø£Ùˆ Cashier
- Ø³ÙŠØªÙ… redirect ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ù„Ù‰ `/pos`

### âœ… Email Uniqueness
- Ø¬Ø±Ø¨ Ø¥Ù†Ø´Ø§Ø¡ tenant Ø¨Ù†ÙØ³ Ø§Ù„Ù€ email Ù…Ø±ØªÙŠÙ†
- Ø³ÙŠØ¸Ù‡Ø± Ø®Ø·Ø£: "Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„"

### âœ… Form Validation
- Ø¬Ø±Ø¨ ØªØ±Ùƒ Ø­Ù‚Ù„ ÙØ§Ø¶ÙŠ
- Ø¬Ø±Ø¨ ÙƒØªØ§Ø¨Ø© email ØºÙŠØ± ØµØ­ÙŠØ­
- Ø¬Ø±Ø¨ password Ø£Ù‚Ù„ Ù…Ù† 6 Ø£Ø­Ø±Ù
- HTML5 validation Ø³ÙŠÙ…Ù†Ø¹Ùƒ

### âœ… Transaction Safety
- Ø¥Ø°Ø§ Ø­ØµÙ„ Ø®Ø·Ø£ ÙÙŠ Ø£ÙŠ Ø®Ø·ÙˆØ©ØŒ ÙƒÙ„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© ØªØ±Ø¬Ø¹ rollback
- Ù„Ù† ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ tenant Ù†Ø§Ù‚Øµ

---

## ğŸ“Š What Happens Behind the Scenes

Ø¹Ù†Ø¯ Ø¥Ù†Ø´Ø§Ø¡ tenant Ø¬Ø¯ÙŠØ¯:

1. âœ… **Validation**: Email uniqueness check
2. âœ… **Slug Generation**: "Ù…Ø·Ø¹Ù… Ø§Ù„Ø£Ù…Ù„" â†’ "Ù…Ø·Ø¹Ù…-Ø§Ù„Ø£Ù…Ù„"
3. âœ… **Transaction Start**: Begin atomic operation
4. âœ… **Create Tenant**: With default settings (Tax 14%, EGP, etc.)
5. âœ… **Create Branch**: Code "MAIN", linked to tenant
6. âœ… **Create Admin User**: Password hashed with BCrypt, Role=Admin
7. âœ… **Commit**: All or nothing
8. âœ… **Response**: Return complete tenant info

---

## ğŸ¨ UI Features

### Form
- Clean, accessible design with Card layout
- Real-time HTML5 validation
- Loading state during submission
- Clear error/success messages
- Auto-reset on success

### Security
- Password field (hidden input)
- Email validation
- Required field indicators
- Min/max length enforcement

---

## ğŸ› Troubleshooting

### Backend not starting?
```bash
# Set JWT Key first
$env:Jwt__Key = [Convert]::ToBase64String((1..40 | ForEach-Object { Get-Random -Max 256 }) -as [byte[]])

# Then run
dotnet run --project src/KasserPro.API
```

### Frontend not starting?
```bash
cd client
npm install
npm run dev
```

### Can't access /owner/tenants?
- ØªØ£ÙƒØ¯ Ø¥Ù†Ùƒ Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ ÙƒÙ€ SystemOwner
- Email: owner@kasserpro.com
- Password: Owner@123

### API returns 401 Unauthorized?
- ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù€ JWT token ÙÙŠ Ø§Ù„Ù€ Authorization header
- ØªØ£ÙƒØ¯ Ø¥Ù† Ø§Ù„Ù€ token Ù„Ù€ SystemOwner Ù…Ø´ Admin

---

## ğŸ“ Next Steps

Ø¨Ø¹Ø¯ Ø§Ù„ØªØ¬Ø±Ø¨Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ:

1. âœ… Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· ÙÙŠ Ø§Ù„Ù€ navigation menu Ù„Ù„Ù€ SystemOwner
2. âœ… Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø© Ù„Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ Tenants
3. âœ… Ø¥Ø¶Ø§ÙØ© Ø¥Ù…ÙƒØ§Ù†ÙŠØ© ØªØ¹Ø·ÙŠÙ„/ØªÙØ¹ÙŠÙ„ Tenant
4. âœ… Ø¥Ø¶Ø§ÙØ© statistics dashboard Ù„Ù„Ù€ SystemOwner
5. âœ… Ø¥Ø¶Ø§ÙØ© email notification Ù„Ù„Ù€ admin Ø§Ù„Ø¬Ø¯ÙŠØ¯

---

## âœ¨ Features Implemented

âœ… SystemOwner role
âœ… Secure tenant creation endpoint
âœ… Transaction-wrapped atomic operations
âœ… Password hashing with BCrypt
âœ… Email uniqueness validation
âœ… Slug generation with collision handling
âœ… Frontend form with validation
âœ… Role-based route protection
âœ… RTK Query API integration
âœ… Error handling and display
âœ… Success feedback
âœ… Auto-reset form

---

**ğŸ‰ Enjoy testing the new feature!**
