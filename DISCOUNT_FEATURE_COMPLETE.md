# ููุฒุฉ ุงูุฎุตู ุจุงููุณุจุฉ ูุงููุจูุบ โ

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅุถุงูุฉ ููุฒุฉ ุงูุฎุตู ุนูู ูุณุชูู ุงูุทูุจ ุจุงููุงููุ ูุน ุฏุนู ููุนูู ูู ุงูุฎุตู:
1. **ุฎุตู ุจุงููุณุจุฉ ุงููุฆููุฉ** (Percentage): ูุซู 10% ุฃู 20%
2. **ุฎุตู ุจูุจูุบ ุซุงุจุช** (Fixed): ูุซู 50 ุฌ.ู ุฃู 100 ุฌ.ู

## ุงููุนุงุฏูุฉ ุงููุงููุฉ

### ุจุฏูู ุฎุตู
```
Subtotal = Sum(UnitPrice ร Quantity)
TaxAmount = Subtotal ร (TaxRate / 100)
Total = Subtotal + TaxAmount
```

### ูุน ุงูุฎุตู
```
Subtotal = Sum(UnitPrice ร Quantity)
DiscountAmount = Subtotal ร (DiscountValue / 100)  [ูููุณุจุฉ]
              OR DiscountValue                      [ูููุจูุบ ุงูุซุงุจุช]
AfterDiscount = Subtotal - DiscountAmount
TaxAmount = AfterDiscount ร (TaxRate / 100)
Total = AfterDiscount + TaxAmount
```

**ููุงุญุธุฉ ูููุฉ:** ุงูุถุฑูุจุฉ ุชูุญุณุจ ุนูู ุงููุจูุบ ุจุนุฏ ุงูุฎุตูุ ูููุณ ูุจูู.

## ุงูุชุบููุฑุงุช ุงููุทุจูุฉ

### Frontend

#### 1. Cart Slice (`client/src/store/slices/cartSlice.ts`)
- ุฅุถุงูุฉ `DiscountType` type: `"Percentage" | "Fixed"`
- ุฅุถุงูุฉ ุญููู ุงูุฎุตู ูู `CartState`:
  - `discountType?: DiscountType`
  - `discountValue?: number`
- ุฅุถุงูุฉ `setDiscount` action ูุชุทุจูู/ุฅูุบุงุก ุงูุฎุตู
- ุชุญุฏูุซ `selectDiscountAmount` selector ูุญุณุงุจ ูููุฉ ุงูุฎุตู
- ุชุญุฏูุซ `selectTaxAmount` ูุญุณุงุจ ุงูุถุฑูุจุฉ ุนูู ุงููุจูุบ ุจุนุฏ ุงูุฎุตู
- ุชุญุฏูุซ `selectTotal` ูุทุฑุญ ุงูุฎุตู ูู ุงูุฅุฌูุงูู
- ุชุญุฏูุซ `clearCart` ููุณุญ ุงูุฎุตู ุนูุฏ ุฅูุฑุงุบ ุงูุณูุฉ

#### 2. useCart Hook (`client/src/hooks/useCart.ts`)
- ุฅุถุงูุฉ `discountAmount`, `discountType`, `discountValue` ูู ุงูููู ุงูููุฑุฌุนุฉ
- ุฅุถุงูุฉ `applyDiscount(type, value)` function
- ุฅุถุงูุฉ `removeDiscount()` function

#### 3. OrderSummary Component (`client/src/components/pos/OrderSummary.tsx`)
- ุนุฑุถ ุณุทุฑ ุงูุฎุตู ุฅุฐุง ูุงู ููุฌูุฏ
- ุนุฑุถ ุฃููููุฉ ููุงุณุจุฉ (% ุฃู ุฌ.ู)
- ุนุฑุถ ุงููุณุจุฉ ุจุฌุงูุจ ุงูุฎุตู ุฅุฐุง ูุงู ูุณุจุฉ ูุฆููุฉ
- ุชูุณูู ุงูุฎุตู ุจููู ุฃุฎุถุฑ ููุชูููุฒ

#### 4. DiscountModal Component (ุฌุฏูุฏ) (`client/src/components/pos/DiscountModal.tsx`)
- ูุงุฌูุฉ ูุงููุฉ ูุฅุถุงูุฉ/ุชุนุฏูู ุงูุฎุตู
- ุงุฎุชูุงุฑ ููุน ุงูุฎุตู (ูุณุจุฉ ุฃู ูุจูุบ)
- ููุญุฉ ุฃุฑูุงู (Numpad) ูุฅุฏุฎุงู ุงููููุฉ
- ุฃุฒุฑุงุฑ ุณุฑูุนุฉ ูููุณุจ ุงูุดุงุฆุนุฉ (5%, 10%, 15%, 20%)
- ูุนุงููุฉ ูุจุงุดุฑุฉ ูููุจูุบ ุจุนุฏ ุงูุฎุตู
- ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช:
  - ุงููุณุจุฉ ูุง ุชุชุฌุงูุฒ 100%
  - ุงููุจูุบ ูุง ูุชุฌุงูุฒ ุงููุฌููุน ุงููุฑุนู
  - ุงููููุฉ ูุฌุจ ุฃู ุชููู ุฃูุจุฑ ูู ุตูุฑ

#### 5. Cart Component (`client/src/components/pos/Cart.tsx`)
- ุฅุถุงูุฉ ุฒุฑ "ุฅุถุงูุฉ ุฎุตู" / "ุชุนุฏูู ุงูุฎุตู"
- ูุชุญ DiscountModal ุนูุฏ ุงูุถุบุท ุนูู ุงูุฒุฑ
- ุนุฑุถ ุญุงูุฉ ุงูุฎุตู ุงูุญุงูู

#### 6. useOrders Hook (`client/src/hooks/useOrders.ts`)
- ุฅุฑุณุงู `discountType` ู `discountValue` ูุน ุงูุทูุจ

#### 7. Types (`client/src/types/order.types.ts`)
- ุฅุถุงูุฉ ุญููู ุงูุฎุตู ูู `CreateOrderRequest`:
  - `discountType?: "Percentage" | "Fixed"`
  - `discountValue?: number`

### Backend

#### 1. CreateOrderRequest DTO (`src/KasserPro.Application/DTOs/Orders/CreateOrderRequest.cs`)
- ุฅุถุงูุฉ ุญููู ุงูุฎุตู:
  ```csharp
  public string? DiscountType { get; set; } // "Percentage" or "Fixed"
  public decimal? DiscountValue { get; set; }
  ```

#### 2. OrderService (`src/KasserPro.Application/Services/Implementations/OrderService.cs`)
- ุชุญุฏูุซ `CreateAsync` ูุชุทุจูู ุงูุฎุตู ูู ุงูู request:
  ```csharp
  DiscountType = request.DiscountType?.ToLower(),
  DiscountValue = request.DiscountValue
  ```
- `CalculateOrderTotals` ูุญุณุจ ุงูุฎุตู ุชููุงุฆูุงู (ูุงู ููุฌูุฏ ูุณุจูุงู)

#### 3. Order Entity (ููุฌูุฏ ูุณุจูุงู)
ุงูุญููู ุงูุชุงููุฉ ูุงูุช ููุฌูุฏุฉ ูู ุงูู Entity:
- `DiscountType` (string)
- `DiscountValue` (decimal?)
- `DiscountAmount` (decimal)

## ุทุฑููุฉ ุงูุงุณุชุฎุฏุงู

### ูููุณุชุฎุฏู ุงูููุงุฆู

1. **ุฅุถุงูุฉ ููุชุฌุงุช ููุณูุฉ**
2. **ุงูุถุบุท ุนูู ุฒุฑ "ุฅุถุงูุฉ ุฎุตู"**
3. **ุงุฎุชูุงุฑ ููุน ุงูุฎุตู:**
   - ูุณุจุฉ ูุฆููุฉ: ููุฎุตููุงุช ุงููุณุจูุฉ (ูุซู 10% ุฎุตู)
   - ูุจูุบ ุซุงุจุช: ููุฎุตููุงุช ุงููุญุฏุฏุฉ (ูุซู 50 ุฌ.ู ุฎุตู)
4. **ุฅุฏุฎุงู ุงููููุฉ:**
   - ุงุณุชุฎุฏุงู ููุญุฉ ุงูุฃุฑูุงู
   - ุฃู ุงูุถุบุท ุนูู ุงูุฃุฒุฑุงุฑ ุงูุณุฑูุนุฉ (ูููุณุจ)
5. **ูุนุงููุฉ ุงููุชูุฌุฉ** ูู ุงูุตูุฏูู ุงูุฃุฎุถุฑ
6. **ุงูุถุบุท ุนูู "ุชุทุจูู ุงูุฎุตู"**
7. **ุฅุชูุงู ุงูุฏูุน ูุงููุนุชุงุฏ**

### ูุฅูุบุงุก ุงูุฎุตู
- ูุชุญ ูุงูุฐุฉ ุงูุฎุตู ูุฑุฉ ุฃุฎุฑู
- ุงูุถุบุท ุนูู ุฒุฑ "ุฅูุบุงุก ุงูุฎุตู"

## ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุฎุตู ุจุงููุณุจุฉ (10%)
```
ุงููุฌููุน ุงููุฑุนู: 100 ุฌ.ู
ุงูุฎุตู (10%): -10 ุฌ.ู
ุจุนุฏ ุงูุฎุตู: 90 ุฌ.ู
ุงูุถุฑูุจุฉ (14%): 12.6 ุฌ.ู
ุงูุฅุฌูุงูู: 102.6 ุฌ.ู
```

### ูุซุงู 2: ุฎุตู ุจูุจูุบ ุซุงุจุช (50 ุฌ.ู)
```
ุงููุฌููุน ุงููุฑุนู: 200 ุฌ.ู
ุงูุฎุตู: -50 ุฌ.ู
ุจุนุฏ ุงูุฎุตู: 150 ุฌ.ู
ุงูุถุฑูุจุฉ (14%): 21 ุฌ.ู
ุงูุฅุฌูุงูู: 171 ุฌ.ู
```

### ูุซุงู 3: ุจุฏูู ุถุฑูุจุฉ
```
ุงููุฌููุน ุงููุฑุนู: 100 ุฌ.ู
ุงูุฎุตู (20%): -20 ุฌ.ู
ุจุนุฏ ุงูุฎุตู: 80 ุฌ.ู
ุงูุถุฑูุจุฉ: 0 ุฌ.ู (ูุนุทูุฉ)
ุงูุฅุฌูุงูู: 80 ุฌ.ู
```

## ููุงุนุฏ ุงูุชุญูู

### Frontend
- โ ุงููููุฉ ูุฌุจ ุฃู ุชููู ุฃูุจุฑ ูู ุตูุฑ
- โ ุงููุณุจุฉ ูุง ุชุชุฌุงูุฒ 100%
- โ ุงููุจูุบ ุงูุซุงุจุช ูุง ูุชุฌุงูุฒ ุงููุฌููุน ุงููุฑุนู
- โ ุงูุฎุตู ููุญุฏ ุชููุงุฆูุงู ุจุงููุฌููุน ุงููุฑุนู

### Backend
- โ ุงูุฎุตู ููุทุจู ุนูู ูุณุชูู ุงูุทูุจ
- โ ุงูุถุฑูุจุฉ ุชูุญุณุจ ุนูู ุงููุจูุบ ุจุนุฏ ุงูุฎุตู
- โ ุงูุฎุตู ููุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ ุงูุฎุตู ูุธูุฑ ูู ุงููุงุชูุฑุฉ ุงููุทุจูุนุฉ

## ุงููููุงุช ุงููุนุฏูุฉ

### Frontend
- โ `client/src/store/slices/cartSlice.ts`
- โ `client/src/hooks/useCart.ts`
- โ `client/src/components/pos/Cart.tsx`
- โ `client/src/components/pos/OrderSummary.tsx`
- โ `client/src/components/pos/DiscountModal.tsx` (ุฌุฏูุฏ)
- โ `client/src/hooks/useOrders.ts`
- โ `client/src/types/order.types.ts`

### Backend
- โ `src/KasserPro.Application/DTOs/Orders/CreateOrderRequest.cs`
- โ `src/KasserPro.Application/Services/Implementations/OrderService.cs`

## ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุงุฑุงุช ูุฏููุฉ ูุทููุจุฉ
- [ ] ุฅุถุงูุฉ ุฎุตู ุจุงููุณุจุฉ (10%)
- [ ] ุฅุถุงูุฉ ุฎุตู ุจูุจูุบ ุซุงุจุช (50 ุฌ.ู)
- [ ] ุชุนุฏูู ุงูุฎุตู
- [ ] ุฅูุบุงุก ุงูุฎุตู
- [ ] ุงูุชุญูู ูู ุงูุญุณุงุจุงุช ูู OrderSummary
- [ ] ุงูุชุญูู ูู ุงูุญุณุงุจุงุช ูู PaymentModal
- [ ] ุฅุชูุงู ุทูุจ ูุน ุฎุตู
- [ ] ุงูุชุญูู ูู ุญูุธ ุงูุฎุตู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- [ ] ุงูุชุญูู ูู ุธููุฑ ุงูุฎุตู ูู ุงููุงุชูุฑุฉ ุงููุทุจูุนุฉ
- [ ] ุงุฎุชุจุงุฑ ูุน ุงูุถุฑูุจุฉ ููุนูุฉ
- [ ] ุงุฎุชุจุงุฑ ูุน ุงูุถุฑูุจุฉ ูุนุทูุฉ

### ุญุงูุงุช ุงูุญุงูุฉ
- [ ] ุฎุตู 100% (ูุฌุจ ุฃู ูุนูู)
- [ ] ุฎุตู ุฃูุจุฑ ูู ุงููุฌููุน ุงููุฑุนู (ูุฌุจ ุฃู ููุญุฏ)
- [ ] ุฎุตู ุตูุฑ (ูุฌุจ ุฃู ููุฑูุถ)
- [ ] ุฎุตู ุณุงูุจ (ูุฌุจ ุฃู ููุฑูุถ)
- [ ] ุฅูุฑุงุบ ุงูุณูุฉ ุจุนุฏ ุฅุถุงูุฉ ุฎุตู (ูุฌุจ ุฃู ูููุณุญ ุงูุฎุตู)

## ููุงุญุธุงุช ูููุฉ

1. **ุงูุฎุตู ุนูู ูุณุชูู ุงูุทูุจ ููุท**: ูุง ููุฌุฏ ุฎุตู ุนูู ูุณุชูู ุงูููุชุฌ ุงููุฑุฏู
2. **ุงูุถุฑูุจุฉ ุจุนุฏ ุงูุฎุตู**: ุงูุถุฑูุจุฉ ุชูุญุณุจ ุนูู ุงููุจูุบ ุจุนุฏ ุทุฑุญ ุงูุฎุตู
3. **ุงูุฎุตู ููุญูุธ**: ุงูุฎุตู ููุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุน ุงูุทูุจ
4. **ุงูุฎุตู ูููุณุญ**: ุนูุฏ ุฅูุฑุงุบ ุงูุณูุฉ ุฃู ุฅุชูุงู ุงูุทูุจุ ูููุณุญ ุงูุฎุตู
5. **ุงูุชุญูู ูู ุงูุตูุงุญูุงุช**: ุญุงููุงู ุฃู ูุณุชุฎุฏู ููููู ุฅุถุงูุฉ ุฎุตู (ูููู ุชูููุฏ ุฐูู ูุงุญูุงู)

## ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

- [ ] ุฅุถุงูุฉ ุตูุงุญูุงุช ููุฎุตู (Admin/Manager ููุท)
- [ ] ุฅุถุงูุฉ ุญุฏ ุฃูุตู ููุฎุตู
- [ ] ุฅุถุงูุฉ ุณุจุจ ุงูุฎุตู (Discount Reason)
- [ ] ุฅุถุงูุฉ ููุฏ ุฎุตู (Discount Code)
- [ ] ุฅุถุงูุฉ ุฎุตู ุนูู ูุณุชูู ุงูููุชุฌ
- [ ] ุฅุถุงูุฉ ุชูุงุฑูุฑ ุงูุฎุตููุงุช
- [ ] ุฅุถุงูุฉ ุชูุจูู ุนูุฏ ุชุฌุงูุฒ ุญุฏ ูุนูู

## ุงูุฎูุงุตุฉ

ุชู ุชุทุจูู ููุฒุฉ ุงูุฎุตู ุจุงููุงูู ุนูู Frontend ู Backend ูุน:
- โ ูุงุฌูุฉ ูุณุชุฎุฏู ุณููุฉ ููุงุถุญุฉ
- โ ุญุณุงุจุงุช ูุงููุฉ ุฏูููุฉ
- โ ุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
- โ ุชูุงูู ูุงูู ูุน ุงููุธุงู ุงูุญุงูู
- โ ุฏุนู ุงูุถุฑูุจุฉ ูุงูุฎุตู ูุนุงู
- โ ุญูุธ ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

ุงูููุฒุฉ ุฌุงูุฒุฉ ููุงุฎุชุจุงุฑ ูุงูุงุณุชุฎุฏุงู! ๐
