# ๐ง ุฅุตูุงุญ ูุดููุฉ ูููุงุช PDF ุงููุนุทูุจุฉ

## โ ุชู ุงูุฅุตูุงุญ!

ุชู ุฅุตูุงุญ ูุดููุฉ ูููุงุช PDF ุงููุนุทูุจุฉ. ุงูุขู ุงูุทุจุงุนุฉ ุชุนูู ุจุดูู ุตุญูุญ ุนูู **Microsoft Print to PDF** ูุฌููุน ุทุงุจุนุงุช PDF ุงูุฃุฎุฑู.

---

## ๐ ุงููุดููุฉ

ุนูุฏ ุงูุทุจุงุนุฉ ุนูู **Microsoft Print to PDF**ุ ูุงูุช ุงููููุงุช ุงููุทุจูุนุฉ ูุนุทูุจุฉ ููุง ุชูุชุญ.

### ุงูุณุจุจ
ุงูููุฏ ุงููุฏูู ูุงู ูุฑุณู **ESC/POS raw bytes** ูุจุงุดุฑุฉ ุฅูู ุงูุทุงุจุนุฉ. ูุฐุง ูุนูู ูุน ุงูุทุงุจุนุงุช ุงูุญุฑุงุฑูุฉ (ูุซู XP-90)ุ ููู **ุทุงุจุนุงุช PDF ูุง ุชููู ESC/POS commands** - ุชุญุชุงุฌ ุฅูู ุจูุงูุงุช PDF ุฃู PostScript ูุนููุฉ.

---

## โ ุงูุญู

ุชู ุฅุถุงูุฉ **ุทุฑููุชูู ููุทุจุงุนุฉ**:

### 1. ุทุจุงุนุฉ ESC/POS (ููุทุงุจุนุงุช ุงูุญุฑุงุฑูุฉ)
- ุชุณุชุฎุฏู ูุน: XP-90, XP-80C, ูุฌููุน ุงูุทุงุจุนุงุช ุงูุญุฑุงุฑูุฉ
- ุชุฑุณู ESC/POS raw bytes ูุจุงุดุฑุฉ
- ุชุฏุนู Barcode, ูุต ุงููุฑู, ุชูุณูู ุฎุงุต

### 2. ุทุจุงุนุฉ PrintDocument (ูุทุงุจุนุงุช PDF)
- ุชุณุชุฎุฏู ูุน: Microsoft Print to PDF, Microsoft XPS, OneNote, Fax
- ุชุฑุณู ุงููุงุชูุฑุฉ ุจุงุณุชุฎุฏุงู GDI+ Graphics
- ุชูุชุฌ ูููุงุช PDF ุตุญูุญุฉ ููุงุจูุฉ ูููุชุญ

---

## ๐ ููู ูุนูู

ุงูููุฏ ุงูุขู ููุชุดู ุชููุงุฆูุงู ููุน ุงูุทุงุจุนุฉ:

```csharp
private bool IsPdfPrinter(string printerName)
{
    var pdfPrinters = new[] { "pdf", "xps", "onenote", "fax" };
    return pdfPrinters.Any(p => printerName.ToLower().Contains(p));
}
```

ุฅุฐุง ูุงูุช ุงูุทุงุจุนุฉ ุชุญุชูู ุนูู "pdf", "xps", "onenote", ุฃู "fax" ูู ุงุณููุงุ ูุณุชุฎุฏู `PrintDocument`.  
ูุฅูุงุ ูุณุชุฎุฏู ESC/POS.

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### 1. ุฃููู ุงูุชุทุจูู ุงููุฏูู
```powershell
Get-Process | Where-Object {$_.ProcessName -like "*KasserPro*"} | Stop-Process -Force
```

### 2. ุดุบู ุงูุชุทุจูู ุงูุฌุฏูุฏ
```powershell
cd G:\POS
Start-Process -FilePath "src\KasserPro.BridgeApp\bin\Debug\net9.0-windows\KasserPro.BridgeApp.exe"
```

### 3. ุชุฃูุฏ ูู ุงูุฅุนุฏุงุฏุงุช
- Double-click ุนูู ุฃููููุฉ System Tray
- ุชุฃูุฏ ูู:
  - Backend URL: `http://localhost:5243`
  - API Key: `test-api-key-123`
  - Printer: `Microsoft Print to PDF`
- ุงุถุบุท Save

### 4. ุงุฎุชุจุฑ ุงูุทุจุงุนุฉ
```powershell
# ุชุฃูุฏ ูู ุฃู Backend ูุนูู ุฃููุงู
Invoke-RestMethod -Uri "http://localhost:5243/api/DeviceTest/status"

# ุงุฎุชุจุฑ ุงูุทุจุงุนุฉ
Invoke-RestMethod -Uri "http://localhost:5243/api/DeviceTest/test-print" -Method Post
```

### 5. ุงูุชุญ ููู PDF
- ุงุฐูุจ ุฅูู: `Documents` folder
- ุงุจุญุซ ุนู ููู PDF ุฌุฏูุฏ
- ุงูุชุญู - ูุฌุจ ุฃู ููุชุญ ุจุดูู ุตุญูุญ!

---

## ๐ ูุง ูุฌุจ ุฃู ุชุฑุงู ูู PDF

ุงููุงุชูุฑุฉ ูุฌุจ ุฃู ุชุญุชูู ุนูู:

```
ูุฑุน ุงูุงุฎุชุจุงุฑ - Test Branch
Receipt: TEST-20260131...
2026-01-31 14:45

================================
ููุชุฌ ุชุฌุฑูุจู 1 - Test Product 1
  2 x 50.00 = 100.00 EGP
ููุชุฌ ุชุฌุฑูุจู 2 - Test Product 2
  1 x 75.50 = 75.50 EGP
================================
Subtotal:     175.50 EGP
Tax (14%):    24.57 EGP
TOTAL:        200.07 EGP
Payment:      ููุฏู - Cash
Cashier:      ูุงุดูุฑ ุชุฌุฑูุจู - Test Cashier

*TEST-20260131...*
```

---

## ๐ฏ ุงููุฑู ุจูู ุงูุทุฑููุชูู

### ESC/POS (ููุทุงุจุนุงุช ุงูุญุฑุงุฑูุฉ)
โ **ุงููููุฒุงุช:**
- Barcode ุญูููู (Code128)
- ูุต ุงููุฑู ุชููุงุฆูุงู
- ุชูุณูู ุฏููู ููุทุงุจุนุงุช ุงูุญุฑุงุฑูุฉ
- ุณุฑุนุฉ ุนุงููุฉ

โ **ุงูุนููุจ:**
- ูุง ูุนูู ูุน ุทุงุจุนุงุช PDF
- ูุญุชุงุฌ ุทุงุจุนุฉ ุญุฑุงุฑูุฉ ุญููููุฉ

### PrintDocument (ูุทุงุจุนุงุช PDF)
โ **ุงููููุฒุงุช:**
- ูุนูู ูุน ุฌููุน ุทุงุจุนุงุช Windows
- ููุชุฌ ูููุงุช PDF ุตุญูุญุฉ
- ุณูู ุงูุงุฎุชุจุงุฑ ุจุฏูู ุทุงุจุนุฉ ุญุฑุงุฑูุฉ

โ **ุงูุนููุจ:**
- Barcode ูุตู ููุท (ููุณ ุญูููู)
- ูุง ูุฏุนู ูุต ุงููุฑู
- ุฃุจุทุฃ ููููุงู

---

## ๐ง ุงูุชุนุฏููุงุช ุงูุชูููุฉ

### ุงูููู ุงููุนุฏู
`src/KasserPro.BridgeApp/Services/PrinterService.cs`

### ุงูุชุบููุฑุงุช ุงูุฑุฆูุณูุฉ

1. **ุฅุถุงูุฉ `IsPdfPrinter()` method**
   - ููุชุดู ููุน ุงูุทุงุจุนุฉ

2. **ุฅุถุงูุฉ `PrintUsingPrintDocumentAsync()` method**
   - ูุทุจุน ุจุงุณุชุฎุฏุงู `PrintDocument`
   - ูุฑุณู ุงููุงุชูุฑุฉ ุจุงุณุชุฎุฏุงู GDI+ Graphics

3. **ุชุนุฏูู `PrintReceiptAsync()` method**
   - ูุฎุชุงุฑ ุงูุทุฑููุฉ ุงูููุงุณุจุฉ ุญุณุจ ููุน ุงูุทุงุจุนุฉ

4. **ุฅุถุงูุฉ using statements**
   - `using System.Drawing;`
   - `using System.Linq;`

---

## ๐ ููุงุญุธุงุช ูููุฉ

### ููุงุฎุชุจุงุฑ (Development)
- ุงุณุชุฎุฏู **Microsoft Print to PDF**
- ุณูู ุงูุงุฎุชุจุงุฑ ุจุฏูู ุทุงุจุนุฉ ุญุฑุงุฑูุฉ
- ููุชุฌ ูููุงุช PDF ูููู ูุชุญูุง ููุดุงุฑูุชูุง

### ููุฅูุชุงุฌ (Production)
- ุงุณุชุฎุฏู **XP-90** ุฃู ุฃู ุทุงุจุนุฉ ุญุฑุงุฑูุฉ
- ุฃูุถู ุฃุฏุงุก ูุชูุณูู
- Barcode ุญูููู ูุงุจู ูููุณุญ

---

## ๐ ุงูุฎูุงุตุฉ

โ **ุงููุดููุฉ**: ูููุงุช PDF ูุนุทูุจุฉ  
โ **ุงูุณุจุจ**: ESC/POS ูุง ูุนูู ูุน ุทุงุจุนุงุช PDF  
โ **ุงูุญู**: ุฅุถุงูุฉ ุทุฑููุฉ ุทุจุงุนุฉ ุฎุงุตุฉ ูุทุงุจุนุงุช PDF  
โ **ุงููุชูุฌุฉ**: ุงูุทุจุงุนุฉ ุชุนูู ุจุดูู ุตุญูุญ ุนูู ุฌููุน ุฃููุงุน ุงูุทุงุจุนุงุช

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุงุฎุชุจุฑ ูุน Microsoft Print to PDF** โ
2. **ุชุฃูุฏ ูู ุฃู ุงููููุงุช ุชูุชุญ ุจุดูู ุตุญูุญ** โ
3. **ุงุฎุชุจุฑ ูุน ุทุงุจุนุฉ ุญุฑุงุฑูุฉ ุญููููุฉ (XP-90)** โณ
4. **ุงุณุชุฎุฏู ูู ุงูุฅูุชุงุฌ** โณ

---

**ุชุงุฑูุฎ ุงูุฅุตูุงุญ**: 31 ููุงูุฑ 2026  
**ุงูุฅุตุฏุงุฑ**: 1.0.1  
**ุงูุญุงูุฉ**: โ ุชู ุงูุฅุตูุงุญ ูุงูุงุฎุชุจุงุฑ

๐ **ูุจุฑูู! ุงููุดููุฉ ุชู ุญููุง!** ๐
