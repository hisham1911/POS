# ๐ ุชุดุบูู ุชุฑุญูู ุจูุงูุงุช ุงููุฎุฒูู

**ุงููุดููุฉ:** ุงููุฎุฒูู ูุงุฑุบ ุฑุบู ูุฌูุฏ ููุชุฌุงุช  
**ุงูุณุจุจ:** ูู ูุชู ุชุดุบูู Data Migration ุจุนุฏ  
**ุงูุญู:** ุชุดุบูู Migration ูููู ุงูุจูุงูุงุช

---

## ๐ฏ ููุงุฐุง ุงููุฎุฒูู ูุงุฑุบุ

### ุงููุธุงู ุงููุฏูู:
```
Product.StockQuantity = 100
```
ูู ููุชุฌ ูู ูููุฉ ูุงุญุฏุฉ ุนุงูุฉ

### ุงููุธุงู ุงูุฌุฏูุฏ:
```
BranchInventory
โโโ Branch 1: Quantity = 50
โโโ Branch 2: Quantity = 50
```
ูู ููุชุฌ ูู ูููุฉ ูุฎุชููุฉ ูู ูู ูุฑุน

**ุงููุดููุฉ:** ุงูุจูุงูุงุช ูุง ุชุฒุงู ูู ุงููุธุงู ุงููุฏูู!

---

## โ ุงูุญู: ุชุดุบูู Data Migration

### ุงูุทุฑููุฉ 1: ุงุณุชุฎุฏุงู Swagger (ุงูุฃุณูู)

1. **ุงูุชุญ Swagger:**
   ```
   http://localhost:5243/swagger
   ```

2. **ุงุจุญุซ ุนู `Migration` section**

3. **ุงุถุบุท ุนูู `POST /api/migration/inventory-data`**

4. **ุงุถุบุท "Try it out"**

5. **ุงุถุบุท "Execute"**

6. **ุงูุชุธุฑ ุญุชู ุชุฑู:**
   ```json
   {
     "success": true,
     "message": "ุชู ุชุฑุญูู ุจูุงูุงุช ุงููุฎุฒูู ุจูุฌุงุญ",
     "data": {
       "productsProcessed": 32,
       "totalUnitsTransferred": 10630,
       "branchesUpdated": 2
     }
   }
   ```

### ุงูุทุฑููุฉ 2: ุงุณุชุฎุฏุงู ููู HTTP

1. **ุงูุชุญ ููู:**
   ```
   test-inventory-migration.http
   ```

2. **ุงุจุญุซ ุนู:**
   ```http
   ### Execute Data Migration
   POST {{baseUrl}}/api/migration/inventory-data
   Authorization: Bearer {{authToken}}
   ```

3. **ุงุถุบุท "Send Request"**

### ุงูุทุฑููุฉ 3: ุงุณุชุฎุฏุงู cURL

```bash
# ุงุญุตู ุนูู ุงูุชููู ุฃููุงู
curl -X POST http://localhost:5243/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@kasserpro.com","password":"Admin@123"}'

# ุงุณุชุฎุฏู ุงูุชููู ูู Migration
curl -X POST http://localhost:5243/api/migration/inventory-data \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"
```

---

## ๐ ูุง ุงูุฐู ุณูุญุฏุซุ

### ูุจู Migration:
```
Products Table:
โโโ Product 1: StockQuantity = 100
โโโ Product 2: StockQuantity = 200
โโโ Product 3: StockQuantity = 150

BranchInventories Table:
โโโ (ูุงุฑุบ)
```

### ุจุนุฏ Migration:
```
Products Table:
โโโ Product 1: StockQuantity = 100 (ูุง ูุฒุงู ููุฌูุฏ)
โโโ Product 2: StockQuantity = 200
โโโ Product 3: StockQuantity = 150

BranchInventories Table:
โโโ Product 1, Branch 1: Quantity = 100
โโโ Product 2, Branch 1: Quantity = 200
โโโ Product 3, Branch 1: Quantity = 150
โโโ Product 1, Branch 2: Quantity = 100
โโโ Product 2, Branch 2: Quantity = 200
โโโ Product 3, Branch 2: Quantity = 150
```

---

## ๐ ุงูุชุญูู ูู ุงููุฌุงุญ

### 1. ุชุญูู ูู ุงูู Response:

ูุฌุจ ุฃู ุชุฑู:
```json
{
  "success": true,
  "message": "ุชู ุชุฑุญูู ุจูุงูุงุช ุงููุฎุฒูู ุจูุฌุงุญ",
  "data": {
    "productsProcessed": 32,
    "totalUnitsTransferred": 10630,
    "branchesUpdated": 2,
    "executionTime": "00:00:02.1234567"
  }
}
```

### 2. ุฃุนุฏ ุชุญููู ุตูุญุฉ ุงููุฎุฒูู:

- ุงุฐูุจ ุฅูู ุตูุญุฉ ุงููุฎุฒูู
- ุงุถุบุท F5
- ูุฌุจ ุฃู ุชุฑู ุฌููุน ุงูููุชุฌุงุช!

### 3. ุชุญูู ูู ุงูุจูุงูุงุช:

```http
GET http://localhost:5243/api/inventory/branch/1
Authorization: Bearer YOUR_TOKEN
```

ูุฌุจ ุฃู ุชุฑู ูุงุฆูุฉ ุจุฌููุน ุงูููุชุฌุงุช ูุน ูููุงุชูุง.

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. Migration ุขูู:
- โ ูุง ูุญุฐู ุฃู ุจูุงูุงุช
- โ ูุง ูุนุฏู `Product.StockQuantity`
- โ ููุท ููุณุฎ ุงูุจูุงูุงุช ุฅูู `BranchInventories`
- โ Transactional (ุฅูุง ููุฌุญ ููู ุฃู ููุดู ููู)

### 2. Idempotent:
- โ ูููู ุชุดุบููู ุนุฏุฉ ูุฑุงุช ุจุฃูุงู
- โ ูู ููุฑุฑ ุงูุจูุงูุงุช
- โ ูุชุญูู ูู ูุฌูุฏ ุงูุจูุงูุงุช ูุจู ุงูุฅุฏุฎุงู

### 3. ูุนูู ูุน ุฌููุน ุงููุฑูุน:
- โ ููุณุฎ ุงูุจูุงูุงุช ูุฌููุน ุงููุฑูุน ุงููุดุทุฉ
- โ ูุญุงูุธ ุนูู ุงููููุงุช ุงูุฃุตููุฉ
- โ ูุถุจุท ReorderLevel ุชููุงุฆูุงู

---

## ๐ ุจุนุฏ Migration

### ุณุชุชููู ูู:

1. **ุนุฑุถ ุงููุฎุฒูู:**
   - ุฑุคูุฉ ุฌููุน ุงูููุชุฌุงุช ูู ูู ูุฑุน
   - ูุนุฑูุฉ ุงููููุงุช ุงููุชููุฑุฉ
   - ุฑุคูุฉ ุชูุจููุงุช ุงููุฎุฒูู ุงูููุฎูุถ

2. **ููู ุงููุฎุฒูู:**
   - ุฅูุดุงุก ุทูุจุงุช ููู ุจูู ุงููุฑูุน
   - ุงูููุงููุฉ ุนูู ุงูุทูุจุงุช
   - ุงุณุชูุงู ุงููุฎุฒูู

3. **ุฅุฏุงุฑุฉ ุงูุฃุณุนุงุฑ:**
   - ุชุนููู ุฃุณุนุงุฑ ูุฎุชููุฉ ููู ูุฑุน
   - ุชูุนูู/ุชุนุทูู ุงูุฃุณุนุงุฑ ุงููุฎุตุตุฉ

4. **ุนุฑุถ ุงูุชูุงุฑูุฑ:**
   - ุชูุฑูุฑ ูุฎุฒูู ุงููุฑุน
   - ุชูุฑูุฑ ุงููุฎุฒูู ุงูููุญุฏ
   - ุชูุฑูุฑ ุณุฌู ุงูููู
   - ุชูุฑูุฑ ุงููุฎุฒูู ุงูููุฎูุถ

---

## ๐ง ุญู ุงููุดุงูู

### ุงููุดููุฉ: "401 Unauthorized"

**ุงูุญู:**
1. ุณุฌู ุฏุฎูู ุฃููุงู
2. ุงุญุตู ุนูู ุงูุชููู
3. ุงุณุชุฎุฏูู ูู ุงูุทูุจ

### ุงููุดููุฉ: "Migration already executed"

**ุงูุญู:**
- ูุฐุง ูุนูู ุฃู Migration ุชู ุจุงููุนู
- ุชุญูู ูู ุตูุญุฉ ุงููุฎุฒูู
- ุฅุฐุง ูุงูุช ูุงุฑุบุฉุ ูุฏ ุชููู ููุงู ูุดููุฉ ุฃุฎุฑู

### ุงููุดููุฉ: "No active branches found"

**ุงูุญู:**
1. ุชุญูู ูู ูุฌูุฏ ูุฑูุน ูุดุทุฉ
2. ุงุฐูุจ ุฅูู ุตูุญุฉ ุงููุฑูุน
3. ุชุฃูุฏ ูู ูุฌูุฏ ูุฑุน ูุงุญุฏ ุนูู ุงูุฃูู

---

## ๐ ุงูุฎุทูุงุช ุงููุงููุฉ (ูู ุงูุจุฏุงูุฉ)

### 1. ุชุฃูุฏ ูู ุชุดุบูู Backend:
```bash
cd src/KasserPro.API
dotnet run
```

### 2. ุงูุชุญ Swagger:
```
http://localhost:5243/swagger
```

### 3. ุณุฌู ุฏุฎูู:
- ุงุฐูุจ ุฅูู `POST /api/auth/login`
- ุงุณุชุฎุฏู:
  ```json
  {
    "email": "admin@kasserpro.com",
    "password": "Admin@123"
  }
  ```
- ุงูุณุฎ ุงูู `token` ูู ุงูู response

### 4. Authorize ูู Swagger:
- ุงุถุบุท ุนูู ุฒุฑ "Authorize" ูู ุงูุฃุนูู
- ุงูุตู ุงูุชููู
- ุงุถุบุท "Authorize"

### 5. ุดุบู Migration:
- ุงุฐูุจ ุฅูู `POST /api/migration/inventory-data`
- ุงุถุบุท "Try it out"
- ุงุถุบุท "Execute"

### 6. ุชุญูู ูู ุงููุชูุฌุฉ:
- ูุฌุจ ุฃู ุชุฑู `success: true`
- ุงุฐูุจ ุฅูู ุตูุญุฉ ุงููุฎุฒูู
- ูุฌุจ ุฃู ุชุฑู ุฌููุน ุงูููุชุฌุงุช!

---

## โ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุชุดุบูู Migration:

```
โ 32 ููุชุฌ ุชู ูุนุงูุฌุชู
โ 10,630 ูุญุฏุฉ ุชู ููููุง
โ 2 ูุฑุน ุชู ุชุญุฏูุซู
โ ุงููุฎุฒูู ูุธูุฑ ูู ุงูุชุทุจูู
โ ุฌููุน ุงูููุฒุงุช ุชุนูู
```

---

## ๐ ุชู!

ุงูุขู ุงููุฎุฒูู ูุงูููุชุฌุงุช **ูุชุฑุงุจุทูู**!

ูู ููุชุฌ ูู ุณุฌู ูู `BranchInventories` ููู ูุฑุน.

ุงุณุชูุชุน ุจุฅุฏุงุฑุฉ ุงููุฎุฒูู ูุชุนุฏุฏ ุงููุฑูุน! ๐
