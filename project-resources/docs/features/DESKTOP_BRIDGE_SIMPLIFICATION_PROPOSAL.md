# ๐ฏ ุงูุชุฑุงุญ ุชุจุณูุท ุชุทุจูู Desktop Bridge

## ุงููุดููุฉ ุงูุญุงููุฉ

ุงูุชุทุจูู ุญุงููุงู ูุญุชูู ุนูู ุฅุนุฏุงุฏุงุช ูุซูุฑุฉ:

- ุฅุนุฏุงุฏุงุช ุงูุทุงุจุนุฉ (Paper Width, Row Height, Margins, Scale...)
- ุฅุนุฏุงุฏุงุช ุงูุฎุทูุท (Font Sizes, Line Spacing...)
- ุฅุนุฏุงุฏุงุช ุงูุนุฑุถ (Show Branch, Barcode, Thank You...)

**ูุฐุง ูุฌุนู:**

- ุงูุชุทุจูู ูุนูุฏ ูููุณุชุฎุฏู ุงูููุงุฆู
- ุตุนูุจุฉ ูู ุงูุตูุงูุฉ (ุฅุนุฏุงุฏุงุช ูู ููุงููู: Web + Desktop)
- ุฎุทุฃ ูุญุชูู ุฅุฐุง ุงุฎุชููุช ุงูุฅุนุฏุงุฏุงุช ุจูู ุงูููุจ ูุงูุฏูุณูุชูุจ

---

## โ ุงูุญู ุงูููุชุฑุญ: ุชุจุณูุท ูุงูู

### ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ

**ููู ูู ููุทู ุงูุทุจุงุนุฉ ุฅูู Backend/Frontend**
ุงูุชุทุจูู Desktop ูุตุจุญ ููุท **ุทุงุจุน ุจุณูุท** - ูุณุชูุจู ุตูุฑุฉ/PDF ุฌุงูุฒ ููุทุจุนู ูุจุงุดุฑุฉ.

---

## ๐๏ธ ุงูุชุตููู ุงูููุชุฑุญ

### 1๏ธโฃ **ุงูู Frontend (React/Web)**

```typescript
// ูู ุงูููุจ ุนูุฏ ุงูุทุจุงุนุฉ:
const printReceipt = async (orderId: number) => {
  // 1. ุฌูุจ ุจูุงูุงุช ุงูุทูุจ
  const receipt = await api.get(`/orders/${orderId}/receipt`);

  // 2. ุชูููุฏ HTML ุฌุงูุฒ ููุทุจุงุนุฉ ูุน ูู ุงูุชูุณููุงุช
  const html = generateReceiptHTML(receipt, {
    paperWidth: "80mm",
    fontSize: "12px",
    showBarcode: true,
    // ... ูู ุงูุฅุนุฏุงุฏุงุช ูู settings ุงูููุจ
  });

  // 3. ุฅุฑุณุงู ููุชุทุจูู ุนุจุฑ SignalR
  await hubConnection.invoke("PrintReceipt", {
    type: "html", // ุฃู 'pdf' ุฃู 'image'
    content: html,
    printerName: "XP-K200L", // ุงุฎุชูุงุฑู
  });
};
```

### 2๏ธโฃ **ุงูุชุทุจูู Desktop (ููุจุณูุท ุฌุฏุงู)**

```csharp
// ุงูุชุทุจูู ูุณุชูุจู ููุท ุฃูุฑ ุงูุทุจุงุนุฉ ุงูุฌุงูุฒ
public class SimplifiedPrinterService
{
    public async Task PrintReceiptAsync(PrintCommand command)
    {
        switch (command.Type)
        {
            case "html":
                await PrintHtmlAsync(command.Content);
                break;
            case "pdf":
                await PrintPdfAsync(command.Content);
                break;
            case "image":
                await PrintImageAsync(command.Content);
                break;
        }
    }

    private async Task PrintHtmlAsync(string html)
    {
        // ุชุญููู HTML ุฅูู ุตูุฑุฉ ุฃู PDF
        // ุซู ุทุจุงุนุฉ ูุจุงุดุฑุฉ ุนูู ุงูุทุงุจุนุฉ
        var bitmap = HtmlToBitmap(html);
        SendToPrinter(bitmap);
    }
}
```

### 3๏ธโฃ **ูุงุฌูุฉ ุงูุฅุนุฏุงุฏุงุช (ููุจุณุทุฉ)**

```xml
<!-- SettingsWindow.xaml - ุฅุนุฏุงุฏุงุช ุจุณูุทุฉ ููุท -->
<Window Height="400" Width="500">
    <StackPanel Padding="20">
        <!-- 1. ุงุชุตุงู Backend -->
        <TextBox Name="BackendUrl" Text="https://localhost:5243"/>
        <TextBox Name="ApiKey" Text="..."/>

        <!-- 2. ุงุฎุชูุงุฑ ุงูุทุงุจุนุฉ ููุท -->
        <ComboBox Name="PrinterList"/>

        <!-- 3. ุฃุฒุฑุงุฑ ุงูุญูุธ -->
        <Button Content="ุญูุธ"/>
    </StackPanel>
</Window>
```

---

## ๐ ุงูููุงุฆุฏ

### 1. **ูููุณุชุฎุฏู**

- โ ูุงุฌูุฉ ุจุณูุทุฉ ุฌุฏุงู (3 ุญููู ููุท)
- โ ูุง ูุญุชุงุฌ ุชุนุฏูู ุฅุนุฏุงุฏุงุช ูุนูุฏุฉ
- โ ูู ุงูุฅุนุฏุงุฏุงุช ูู ููุงู ูุงุญุฏ (ุงูููุจ)

### 2. **ูููุทูุฑ**

- โ ููุฏ ุฃูู ูู Desktop App
- โ ุตูุงูุฉ ุฃุณูู
- โ ุฅุนุฏุงุฏุงุช ูุฑูุฒูุฉ ูู Database
- โ ูููู ุชุญุฏูุซ ุงูุชูุณููุงุช ูู ุงูููุจ ุจุฏูู ุชุญุฏูุซ Desktop App

### 3. **ููุฃุฏุงุก**

- โ Desktop App ุฎููู ุฌุฏุงู (< 5MB)
- โ ุงุณุชููุงู ููุงุฑุฏ ุฃูู
- โ ุณุฑุนุฉ ุทุจุงุนุฉ ุฃุนูู (ุจูุงูุงุช ุฌุงูุฒุฉ)

---

## ๐ ุฎุทุฉ ุงูุชูููุฐ

### ุงููุฑุญูุฉ 1: ุฅุนุฏุงุฏ Backend (ุฃุณุจูุน)

```csharp
// API Endpoint ุฌุฏูุฏ
[HttpPost("api/receipts/generate")]
public async Task<IActionResult> GenerateReceipt([FromBody] ReceiptRequest request)
{
    var html = _receiptGenerator.GenerateHTML(request);
    var pdf = _pdfService.ConvertToPdf(html);

    return Ok(new {
        html = html,
        pdf = Convert.ToBase64String(pdf),
        timestamp = DateTime.Now
    });
}
```

### ุงููุฑุญูุฉ 2: ุชุญุฏูุซ Frontend (ุฃุณุจูุน)

- ุฅุถุงูุฉ ููุชุจุฉ HTML-to-PDF (ูุซู `html2canvas` ุฃู `jsPDF`)
- ุจูุงุก Receipt Template Component
- ุฅุถุงูุฉ Print Settings ูู UI

### ุงููุฑุญูุฉ 3: ุชุจุณูุท Desktop App (3 ุฃูุงู)

- ุญุฐู ูู ูููุงุช Settings ุงูุญุงููุฉ
- ุฅุฒุงูุฉ `PrinterService` ุงููุนูุฏ
- ุจูุงุก `SimplePrintService` ุฌุฏูุฏ
- ุชุญุฏูุซ `SettingsWindow.xaml`

### ุงููุฑุญูุฉ 4: ุงุฎุชุจุงุฑ ููุดุฑ (ุฃุณุจูุน)

- ุงุฎุชุจุงุฑ ุนูู ุทุงุจุนุงุช ูุฎุชููุฉ
- ุงุฎุชุจุงุฑ ููุงุณุงุช ูุฑู ูุชุนุฏุฏุฉ
- ุชูุซูู ุงูู API ุงูุฌุฏูุฏ

---

## ๐ง ุงูุชูููุงุช ุงูููุชุฑุญุฉ

### Frontend

- **html2canvas**: ุชุญููู HTML ุฅูู ุตูุฑุฉ
- **jsPDF**: ุชูููุฏ PDF ูู HTML
- **Handlebars/React**: Template engine ููููุงุชูุฑ

### Desktop

- **WebView2**: ุนุฑุถ HTML ุฅุฐุง ูุฒู ุงูุฃูุฑ
- **PdfiumViewer**: ุนุฑุถ PDF
- **System.Drawing**: ุทุจุงุนุฉ ุงูุตูุฑ

---

## ๐ ููุงุฑูุฉ ุงูุชุตููููู

| ุงูููุฒุฉ                  | ุงูุญุงูู (ูุนูุฏ) | ุงูููุชุฑุญ (ุจุณูุท) |
| ----------------------- | ------------- | -------------- |
| ุนุฏุฏ ูููุงุช ุงูุฅุนุฏุงุฏุงุช     | 15+           | 3 ููุท          |
| ุญุฌู Desktop App         | ~15MB         | ~5MB           |
| ุฅุนุฏุงุฏุงุช ุงูุทุจุงุนุฉ         | Desktop       | Web (ูุฑูุฒูุฉ)   |
| ุณูููุฉ ุงูุชุญุฏูุซ           | ุตุนุจ           | ุณูู ุฌุฏุงู       |
| ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู          | ูุนูุฏุฉ         | ุจุณูุทุฉ          |
| ููุช ุงูุชุทููุฑ ูููุฒุฉ ุฌุฏูุฏุฉ | 2-3 ุฃูุงู      | 1 ููู          |

---

## ๐ ุงูุฎุทูุฉ ุงูุชุงููุฉ

ูู ุชุฑูุฏ ุงูุจุฏุก ูู ุงูุชูููุฐุ ุฃูุชุฑุญ:

1. **ุงูุขู**: ูุจูู Receipt HTML Generator ูู Backend
2. **ุจุนุฏูุง**: ูุฑุจุทู ุจู Frontend
3. **ุฃุฎูุฑุงู**: ููุจุณุท Desktop App

---

## ๐ ููุงุญุธุงุช ุชูููุฉ

### ููุงุฐุง HTML ุฃูุถู ูู ESC/POSุ

- โ ุฃุณูู ูู ุงูุชุนุฏูู (CSS/HTML)
- โ ูุนุงููุฉ ูุจุงุดุฑุฉ ูู ุงููุชุตูุญ
- โ ุฏุนู ุตูุฑ ูุจุงุฑููุฏ ูQR Code ุจุณูููุฉ
- โ ูุง ูุนุชูุฏ ุนูู ุฃูุงูุฑ ุฎุงุตุฉ ุจููุน ุงูุทุงุจุนุฉ

### ููุงุฐุง ูููู ุงูููุทู ููู Backendุ

- โ ุฅุนุฏุงุฏุงุช ูุฑูุฒูุฉ ูู Database
- โ ูููู ุชุนุฏูููุง ุจุฏูู ุฅุนุงุฏุฉ ูุดุฑ ุชุทุจูู
- โ ููุณ ุงูุชูุณูู ููู ุงููุฑูุน
- โ ุณูููุฉ ุนูู A/B Testing

---

**ูุฑุงุฑุ** ๐ค
